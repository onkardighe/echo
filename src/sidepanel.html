<!DOCTYPE html>
<html>

<head>
    <title>Echo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="sidepanel.css">
</head>

<body>
    <div class="container">
        <header class="app-header">
            <div class="logo">
                <svg class="logo-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M8 12a4 4 0 0 0 8 0" />
                    <circle cx="12" cy="10" r="1" fill="currentColor" />
                </svg>
                <span class="logo-text">Echo</span>
            </div>
            <div class="connection-badge" id="connection-badge">
                <span class="badge-dot"></span>
                <span id="connection-status">Ready</span>
            </div>
        </header>

        <!-- Error Banner -->
        <div id="error-banner" class="error-banner hidden"></div>

        <div id="setup-panel" class="panel">
            <div class="controls">
                <button id="start-call-btn" class="btn btn-primary">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="5 3 19 12 5 21 5 3" />
                    </svg>
                    <span>Start Echo</span>
                </button>
                <button id="join-call-btn" class="btn btn-secondary">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
                        <polyline points="10 17 15 12 10 7" />
                        <line x1="15" y1="12" x2="3" y2="12" />
                    </svg>
                    <span>Join Echo</span>
                </button>
            </div>

            <!-- Host Flow: Create Room -->
            <div id="create-room-area" class="hidden panel-section">
                <h3 class="section-title">Create a Room</h3>
                <div class="form-group">
                    <label for="room-name-input">Room Name</label>
                    <input type="text" id="room-name-input" placeholder="My Room" />
                </div>
                <div class="form-group">
                    <label for="room-password-input">Password</label>
                    <input type="password" id="room-password-input" placeholder="Enter a secure password" />
                </div>
                <button id="create-room-btn" class="btn btn-primary btn-full">
                    <span class="btn-text">Create Room</span>
                    <span class="btn-spinner"></span>
                </button>
            </div>

            <!-- Guest Flow: Room List -->
            <div id="room-list-area" class="hidden panel-section">
                <div class="section-header">
                    <h3 class="section-title">Active Rooms</h3>
                    <button id="refresh-rooms-btn" class="btn btn-icon" title="Refresh rooms">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M23 4v6h-6" />
                            <path d="M1 20v-6h6" />
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10" />
                            <path d="M20.49 15a9 9 0 0 1-14.85 3.36L1 14" />
                        </svg>
                    </button>
                </div>
                <div id="rooms-list" class="rooms-list">
                    <!-- Rooms will be dynamically added here -->
                </div>
            </div>
        </div>

        <!-- Password Modal -->
        <div id="password-modal" class="modal hidden">
            <div class="modal-backdrop"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                        <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                    </svg>
                    <h3>Enter Password</h3>
                </div>
                <p id="modal-room-name" class="modal-subtitle"></p>
                <div class="form-group">
                    <input type="password" id="modal-password-input" placeholder="Room password" />
                </div>
                <div id="modal-error" class="error-text hidden"></div>
                <div class="modal-actions">
                    <button id="modal-cancel-btn" class="btn btn-secondary">Cancel</button>
                    <button id="modal-join-btn" class="btn btn-primary">
                        <span class="btn-text">Join</span>
                        <span class="btn-spinner"></span>
                    </button>
                </div>
            </div>
        </div>

        <div id="call-panel" class="hidden panel">
            <div class="user-list">
                <h3 class="section-title">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                        <circle cx="9" cy="7" r="4" />
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                        <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                    </svg>
                    Participants
                </h3>
                <div id="connected-users-list" class="users-list">
                    <!-- Users will be added here dynamically -->
                </div>
            </div>

            <div class="call-controls">
                <button id="toggle-mic-btn" class="btn btn-control">
                    <span class="mic-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
                            <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                            <line x1="12" y1="19" x2="12" y2="23" />
                            <line x1="8" y1="23" x2="16" y2="23" />
                        </svg>
                    </span>
                    <span class="mic-label">Mute</span>
                </button>
                <button id="end-call-btn" class="btn btn-danger">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
                        <line x1="1" y1="1" x2="23" y2="23" />
                    </svg>
                    <span>End Echo</span>
                </button>
            </div>
        </div>
    </div>
    <script type="module" src="sidepanel.js"></script>
</body>

</html>